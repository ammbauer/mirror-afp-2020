%
\begin{isabellebody}%
\setisabellecontext{Residual{\isacharunderscore}Graph}%
%
\isamarkupsection{Residual Graph%
}
\isamarkuptrue%
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Residual{\isacharunderscore}Graph\isanewline
\isakeyword{imports}\ Network\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\begin{isamarkuptext}%
In this theory, we define the residual graph.%
\end{isamarkuptext}\isamarkuptrue%
%
\isamarkupsubsection{Definition%
}
\isamarkuptrue%
%
\begin{isamarkuptext}%
The \emph{residual graph} of a network and a flow indicates how much 
  flow can be effectively pushed along or reverse to a network edge,
  by increasing or decreasing the flow on that edge:%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ residualGraph\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharunderscore}\ graph\ {\isasymRightarrow}\ {\isacharunderscore}\ flow\ {\isasymRightarrow}\ {\isacharunderscore}\ graph{\isachardoublequoteclose}\isanewline
\isakeyword{where}\ {\isachardoublequoteopen}residualGraph\ c\ f\ {\isasymequiv}\ {\isasymlambda}{\isacharparenleft}u{\isacharcomma}\ v{\isacharparenright}{\isachardot}\isanewline
\ \ if\ {\isacharparenleft}u{\isacharcomma}\ v{\isacharparenright}\ {\isasymin}\ Graph{\isachardot}E\ c\ then\isanewline
\ \ \ \ c\ {\isacharparenleft}u{\isacharcomma}\ v{\isacharparenright}\ {\isacharminus}\ f\ {\isacharparenleft}u{\isacharcomma}\ v{\isacharparenright}\isanewline
\ \ else\ if\ {\isacharparenleft}v{\isacharcomma}\ u{\isacharparenright}\ {\isasymin}\ Graph{\isachardot}E\ c\ then\isanewline
\ \ \ \ f\ {\isacharparenleft}v{\isacharcomma}\ u{\isacharparenright}\isanewline
\ \ else\isanewline
\ \ \ \ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{context}\isamarkupfalse%
\ Network\ \isakeyword{begin}\isanewline
\ \ \isanewline
\isacommand{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}cf{\isacharunderscore}of\ {\isasymequiv}\ residualGraph\ c{\isachardoublequoteclose}\isanewline
\isacommand{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}cfE{\isacharunderscore}of\ f\ {\isasymequiv}\ Graph{\isachardot}E\ {\isacharparenleft}cf{\isacharunderscore}of\ f{\isacharparenright}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
The edges of the residual graph are either parallel or reverse 
  to the edges of the network.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ cfE{\isacharunderscore}of{\isacharunderscore}ss{\isacharunderscore}invE{\isacharcolon}\ {\isachardoublequoteopen}cfE{\isacharunderscore}of\ cf\ {\isasymsubseteq}\ E\ {\isasymunion}\ E{\isasyminverse}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ residualGraph{\isacharunderscore}def\ Graph{\isachardot}E{\isacharunderscore}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ cfE{\isacharunderscore}of{\isacharunderscore}ss{\isacharunderscore}VxV{\isacharcolon}\ {\isachardoublequoteopen}cfE{\isacharunderscore}of\ f\ {\isasymsubseteq}\ V{\isasymtimes}V{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ V{\isacharunderscore}def\isanewline
\ \ \isacommand{unfolding}\isamarkupfalse%
\ residualGraph{\isacharunderscore}def\ Graph{\isachardot}E{\isacharunderscore}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \ \isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ cfE{\isacharunderscore}of{\isacharunderscore}finite{\isacharbrackleft}simp{\isacharcomma}\ intro{\isacharbang}{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}cfE{\isacharunderscore}of\ f{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ finite{\isacharunderscore}subset{\isacharbrackleft}OF\ cfE{\isacharunderscore}of{\isacharunderscore}ss{\isacharunderscore}VxV{\isacharbrackright}\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ cf{\isacharunderscore}no{\isacharunderscore}self{\isacharunderscore}loop{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}u{\isacharcomma}u{\isacharparenright}{\isasymnotin}cfE{\isacharunderscore}of\ f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ a{\isadigit{1}}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}u{\isacharcomma}\ u{\isacharparenright}\ {\isasymin}\ cfE{\isacharunderscore}of\ f{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}u{\isacharcomma}\ u{\isacharparenright}\ {\isasymnotin}\ E{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ no{\isacharunderscore}parallel{\isacharunderscore}edge\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ a{\isadigit{1}}\ \isacommand{unfolding}\isamarkupfalse%
\ Graph{\isachardot}E{\isacharunderscore}def\ residualGraph{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\ \ \isanewline
\isacommand{end}\isamarkupfalse%
%
\begin{isamarkuptext}%
Let's fix a network with a preflow \isa{f} on it%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{context}\isamarkupfalse%
\ NPreflow\isanewline
\isakeyword{begin}%
\begin{isamarkuptext}%
We abbreviate the residual graph by \isa{cf}.%
\end{isamarkuptext}\isamarkuptrue%
\ \ \isacommand{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}cf\ {\isasymequiv}\ residualGraph\ c\ f{\isachardoublequoteclose}\isanewline
\ \ \isacommand{sublocale}\isamarkupfalse%
\ cf{\isacharcolon}\ Graph\ cf%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{{\isachardot}}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\ \ \isacommand{lemmas}\isamarkupfalse%
\ cf{\isacharunderscore}def\ {\isacharequal}\ residualGraph{\isacharunderscore}def{\isacharbrackleft}of\ c\ f{\isacharbrackright}%
\isamarkupsubsection{Properties%
}
\isamarkuptrue%
\isacommand{lemmas}\isamarkupfalse%
\ cfE{\isacharunderscore}ss{\isacharunderscore}invE\ {\isacharequal}\ cfE{\isacharunderscore}of{\isacharunderscore}ss{\isacharunderscore}invE{\isacharbrackleft}of\ f{\isacharbrackright}%
\begin{isamarkuptext}%
The nodes of the residual graph are exactly the nodes of the network.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ resV{\isacharunderscore}netV{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}cf{\isachardot}V\ {\isacharequal}\ V{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}V\ {\isasymsubseteq}\ Graph{\isachardot}V\ cf{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ \isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ u\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}u\ {\isasymin}\ V{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ v\ \isakeyword{where}\ {\isachardoublequoteopen}{\isacharparenleft}u{\isacharcomma}\ v{\isacharparenright}\ {\isasymin}\ E\ {\isasymor}\ {\isacharparenleft}v{\isacharcomma}\ u{\isacharparenright}\ {\isasymin}\ E{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ V{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{{\isacharbraceleft}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}u{\isacharcomma}\ v{\isacharparenright}\ {\isasymin}\ E{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}u{\isacharcomma}\ v{\isacharparenright}\ {\isasymin}\ Graph{\isachardot}E\ cf\ {\isasymor}\ {\isacharparenleft}v{\isacharcomma}\ u{\isacharparenright}\ {\isasymin}\ Graph{\isachardot}E\ cf{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isacharparenleft}u{\isacharcomma}\ v{\isacharparenright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}cf\ {\isacharparenleft}u{\isacharcomma}\ v{\isacharparenright}\ {\isacharequal}\ c\ {\isacharparenleft}u{\isacharcomma}\ v{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ residualGraph{\isacharunderscore}def\ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isacharparenleft}u{\isacharcomma}\ v{\isacharparenright}\ {\isasymin}\ E{\isacharbackquoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp{\isacharcolon}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}cf\ {\isacharparenleft}u{\isacharcomma}\ v{\isacharparenright}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isacharparenleft}u{\isacharcomma}\ v{\isacharparenright}\ {\isasymin}\ E{\isacharbackquoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ E{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{unfolding}\isamarkupfalse%
\ Graph{\isachardot}E{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isacharparenleft}u{\isacharcomma}\ v{\isacharparenright}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}cf\ {\isacharparenleft}v{\isacharcomma}\ u{\isacharparenright}\ {\isacharequal}\ f\ {\isacharparenleft}u{\isacharcomma}\ v{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ residualGraph{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isacharparenleft}u{\isacharcomma}\ v{\isacharparenright}\ {\isasymin}\ E{\isacharbackquoteclose}\ no{\isacharunderscore}parallel{\isacharunderscore}edge\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}cf\ {\isacharparenleft}v{\isacharcomma}\ u{\isacharparenright}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}f\ {\isacharparenleft}u{\isacharcomma}\ v{\isacharparenright}\ {\isasymnoteq}\ {\isadigit{0}}{\isacartoucheclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{unfolding}\isamarkupfalse%
\ Graph{\isachardot}E{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{{\isacharbraceright}}\isamarkupfalse%
\ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{{\isacharbraceleft}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}v{\isacharcomma}\ u{\isacharparenright}\ {\isasymin}\ E{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}v{\isacharcomma}\ u{\isacharparenright}\ {\isasymin}\ Graph{\isachardot}E\ cf\ {\isasymor}\ {\isacharparenleft}u{\isacharcomma}\ v{\isacharparenright}\ {\isasymin}\ Graph{\isachardot}E\ cf{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isacharparenleft}v{\isacharcomma}\ u{\isacharparenright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}cf\ {\isacharparenleft}v{\isacharcomma}\ u{\isacharparenright}\ {\isacharequal}\ c\ {\isacharparenleft}v{\isacharcomma}\ u{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ residualGraph{\isacharunderscore}def\ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isacharparenleft}v{\isacharcomma}\ u{\isacharparenright}\ {\isasymin}\ E{\isacharbackquoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}cf\ {\isacharparenleft}v{\isacharcomma}\ u{\isacharparenright}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isacharparenleft}v{\isacharcomma}\ u{\isacharparenright}\ {\isasymin}\ E{\isacharbackquoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ E{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{unfolding}\isamarkupfalse%
\ Graph{\isachardot}E{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isacharparenleft}v{\isacharcomma}\ u{\isacharparenright}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}cf\ {\isacharparenleft}u{\isacharcomma}\ v{\isacharparenright}\ {\isacharequal}\ f\ {\isacharparenleft}v{\isacharcomma}\ u{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ residualGraph{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isacharparenleft}v{\isacharcomma}\ u{\isacharparenright}\ {\isasymin}\ E{\isacharbackquoteclose}\ no{\isacharunderscore}parallel{\isacharunderscore}edge\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}cf\ {\isacharparenleft}u{\isacharcomma}\ v{\isacharparenright}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}f\ {\isacharparenleft}v{\isacharcomma}\ u{\isacharparenright}\ {\isasymnoteq}\ {\isadigit{0}}{\isacartoucheclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{unfolding}\isamarkupfalse%
\ Graph{\isachardot}E{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{{\isacharbraceright}}\isamarkupfalse%
\ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}u{\isasymin}cf{\isachardot}V{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ cf{\isachardot}V{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\ \ \isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}Graph{\isachardot}V\ cf\ {\isasymsubseteq}\ V{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ cfE{\isacharunderscore}ss{\isacharunderscore}invE\ \isacommand{unfolding}\isamarkupfalse%
\ Graph{\isachardot}V{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Note, that Isabelle is powerful enough to prove the above case 
  distinctions completely automatically, although it takes some time:%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ {\isachardoublequoteopen}cf{\isachardot}V\ {\isacharequal}\ V{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ residualGraph{\isacharunderscore}def\ Graph{\isachardot}E{\isacharunderscore}def\ Graph{\isachardot}V{\isacharunderscore}def\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ no{\isacharunderscore}parallel{\isacharunderscore}edge{\isacharbrackleft}unfolded\ E{\isacharunderscore}def{\isacharbrackright}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
As the residual graph has the same nodes as the network, it is also finite:%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{sublocale}\isamarkupfalse%
\ cf{\isacharcolon}\ Finite{\isacharunderscore}Graph\ cf\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ unfold{\isacharunderscore}locales\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The capacities on the edges of the residual graph are non-negative%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ resE{\isacharunderscore}nonNegative{\isacharcolon}\ {\isachardoublequoteopen}cf\ e\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ e{\isacharsemicolon}\ simp{\isacharparenright}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ u\ v\isanewline
\ \ \isacommand{{\isacharbraceleft}}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}u{\isacharcomma}\ v{\isacharparenright}\ {\isasymin}\ E{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}cf\ {\isacharparenleft}u{\isacharcomma}\ v{\isacharparenright}\ {\isacharequal}\ c\ {\isacharparenleft}u{\isacharcomma}\ v{\isacharparenright}\ {\isacharminus}\ f\ {\isacharparenleft}u{\isacharcomma}\ v{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ cf{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}cf\ {\isacharparenleft}u{\isacharcomma}v{\isacharparenright}\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ capacity{\isacharunderscore}const\ cap{\isacharunderscore}non{\isacharunderscore}negative\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{{\isacharbraceright}}\isamarkupfalse%
\ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{{\isacharbraceleft}}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}v{\isacharcomma}\ u{\isacharparenright}\ {\isasymin}\ E{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}cf\ {\isacharparenleft}u{\isacharcomma}v{\isacharparenright}\ {\isacharequal}\ f\ {\isacharparenleft}v{\isacharcomma}\ u{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ no{\isacharunderscore}parallel{\isacharunderscore}edge\ \isacommand{unfolding}\isamarkupfalse%
\ cf{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}cf\ {\isacharparenleft}u{\isacharcomma}v{\isacharparenright}\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ capacity{\isacharunderscore}const\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{{\isacharbraceright}}\isamarkupfalse%
\ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{{\isacharbraceleft}}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}u{\isacharcomma}\ v{\isacharparenright}\ {\isasymnotin}\ E{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharparenleft}v{\isacharcomma}\ u{\isacharparenright}\ {\isasymnotin}\ E{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}cf\ {\isacharparenleft}u{\isacharcomma}v{\isacharparenright}\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ residualGraph{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{{\isacharbraceright}}\isamarkupfalse%
\ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}cf\ {\isacharparenleft}u{\isacharcomma}v{\isacharparenright}\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Again, there is an automatic proof%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ {\isachardoublequoteopen}cf\ e\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}cases\ e{\isacharparenright}\isanewline
\ \ \isacommand{unfolding}\isamarkupfalse%
\ residualGraph{\isacharunderscore}def\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ no{\isacharunderscore}parallel{\isacharunderscore}edge\ capacity{\isacharunderscore}const\ cap{\isacharunderscore}positive\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
All edges of the residual graph are labeled with positive capacities:%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{corollary}\isamarkupfalse%
\ resE{\isacharunderscore}positive{\isacharcolon}\ {\isachardoublequoteopen}e\ {\isasymin}\ cf{\isachardot}E\ {\isasymLongrightarrow}\ cf\ e\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}e\ {\isasymin}\ cf{\isachardot}E{\isachardoublequoteclose}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}cf\ e\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ cf{\isachardot}E{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{using}\isamarkupfalse%
\ resE{\isacharunderscore}nonNegative\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}meson\ eq{\isacharunderscore}iff\ not{\isacharunderscore}le{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\ \ \ \ \ \ \isanewline
\ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ reverse{\isacharunderscore}flow{\isacharcolon}\ {\isachardoublequoteopen}Preflow\ cf\ s\ t\ f{\isacharprime}\ {\isasymLongrightarrow}\ {\isasymforall}{\isacharparenleft}u{\isacharcomma}\ v{\isacharparenright}\ {\isasymin}\ E{\isachardot}\ f{\isacharprime}\ {\isacharparenleft}v{\isacharcomma}\ u{\isacharparenright}\ {\isasymle}\ f\ {\isacharparenleft}u{\isacharcomma}\ v{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ asm{\isacharcolon}\ {\isachardoublequoteopen}Preflow\ cf\ s\ t\ f{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{interpret}\isamarkupfalse%
\ f{\isacharprime}{\isacharcolon}\ Preflow\ cf\ s\ t\ f{\isacharprime}\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isanewline
\ \ \isacommand{{\isacharbraceleft}}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ u\ v\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}u{\isacharcomma}\ v{\isacharparenright}\ {\isasymin}\ E{\isachardoublequoteclose}\isanewline
\ \ \ \ \isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}cf\ {\isacharparenleft}v{\isacharcomma}\ u{\isacharparenright}\ {\isacharequal}\ f\ {\isacharparenleft}u{\isacharcomma}\ v{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ residualGraph{\isacharunderscore}def\ \isacommand{using}\isamarkupfalse%
\ no{\isacharunderscore}parallel{\isacharunderscore}edge\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}f{\isacharprime}\ {\isacharparenleft}v{\isacharcomma}\ u{\isacharparenright}\ {\isasymle}\ cf\ {\isacharparenleft}v{\isacharcomma}\ u{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ f{\isacharprime}{\isachardot}capacity{\isacharunderscore}const\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}f{\isacharprime}\ {\isacharparenleft}v{\isacharcomma}\ u{\isacharparenright}\ {\isasymle}\ f\ {\isacharparenleft}u{\isacharcomma}\ v{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{{\isacharbraceright}}\isamarkupfalse%
\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \ \isanewline
%
\endisadelimproof
\isanewline
\ \ \isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ Network{\isacharparenright}\ {\isachardoublequoteopen}flow{\isacharunderscore}of{\isacharunderscore}cf\ cf\ e\ {\isasymequiv}\ {\isacharparenleft}if\ {\isacharparenleft}e{\isasymin}E{\isacharparenright}\ then\ c\ e\ {\isacharminus}\ cf\ e\ else\ {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ NPreflow{\isacharparenright}\ E{\isacharunderscore}ss{\isacharunderscore}cfinvE{\isacharcolon}\ {\isachardoublequoteopen}E\ {\isasymsubseteq}\ Graph{\isachardot}E\ cf\ {\isasymunion}\ {\isacharparenleft}Graph{\isachardot}E\ cf{\isacharparenright}{\isasyminverse}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ residualGraph{\isacharunderscore}def\ Graph{\isachardot}E{\isacharunderscore}def\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}clarsimp{\isacharparenright}\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ no{\isacharunderscore}parallel{\isacharunderscore}edge\ \isanewline
\ \ \isacommand{unfolding}\isamarkupfalse%
\ E{\isacharunderscore}def\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ {\isacharparenright}\isanewline
\ \ \isacommand{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Nodes with positive excess must have an outgoing edge in the 
  residual graph. 

  Intuitively: The excess flow must come from somewhere.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ active{\isacharunderscore}has{\isacharunderscore}cf{\isacharunderscore}outgoing{\isacharcolon}\ {\isachardoublequoteopen}excess\ f\ u\ {\isachargreater}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ cf{\isachardot}outgoing\ u\ {\isasymnoteq}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\ \ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ excess{\isacharunderscore}def\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}\ sum\ f\ {\isacharparenleft}incoming\ u{\isacharparenright}\ {\isacharminus}\ sum\ f\ {\isacharparenleft}outgoing\ u{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}\ sum\ f\ {\isacharparenleft}incoming\ u{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ diff{\isacharunderscore}gt{\isacharunderscore}{\isadigit{0}}{\isacharunderscore}iff{\isacharunderscore}gt\ linorder{\isacharunderscore}neqE{\isacharunderscore}linordered{\isacharunderscore}idom\ linorder{\isacharunderscore}not{\isacharunderscore}le\ \isanewline
\ \ \ \ \ \ \ \ sum{\isacharunderscore}f{\isacharunderscore}non{\isacharunderscore}negative{\isacharparenright}\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ f{\isacharunderscore}non{\isacharunderscore}negative\ \isacommand{obtain}\isamarkupfalse%
\ e\ \isakeyword{where}\ {\isachardoublequoteopen}e{\isasymin}incoming\ u{\isachardoublequoteclose}\ {\isachardoublequoteopen}f\ e\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}meson\ not{\isacharunderscore}le\ sum{\isacharunderscore}nonpos{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ v\ \isakeyword{where}\ {\isachardoublequoteopen}{\isacharparenleft}v{\isacharcomma}u{\isacharparenright}{\isasymin}E{\isachardoublequoteclose}\ {\isachardoublequoteopen}f\ {\isacharparenleft}v{\isacharcomma}u{\isacharparenright}\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ incoming{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}cf\ {\isacharparenleft}u{\isacharcomma}v{\isacharparenright}\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ residualGraph{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{unfolding}\isamarkupfalse%
\ cf{\isachardot}outgoing{\isacharunderscore}def\ cf{\isachardot}E{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ fastforce\ \ \ \isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \ \ \ \ \ \isanewline
%
\endisadelimproof
\ \ \ \ \isanewline
\ \ \ \ \isanewline
\ \ \ \ \isanewline
\isacommand{end}\isamarkupfalse%
\ %
\isamarkupcmt{Network with preflow%
}
\isanewline
\ \ \isanewline
\ \ \isanewline
\isacommand{locale}\isamarkupfalse%
\ RPreGraph\ %
\isamarkupcmt{Locale that characterizes a residual graph of a network%
}
\isanewline
{\isacharequal}\ Network\ {\isacharplus}\isanewline
\ \ \isakeyword{fixes}\ cf\isanewline
\ \ \isakeyword{assumes}\ EX{\isacharunderscore}RPG{\isacharcolon}\ {\isachardoublequoteopen}{\isasymexists}f{\isachardot}\ NPreflow\ c\ s\ t\ f\ {\isasymand}\ cf\ {\isacharequal}\ residualGraph\ c\ f{\isachardoublequoteclose}\isanewline
\isakeyword{begin}\ \ \isanewline
\isanewline
\ \ \isacommand{lemma}\isamarkupfalse%
\ this{\isacharunderscore}loc{\isacharunderscore}rpg{\isacharcolon}\ {\isachardoublequoteopen}RPreGraph\ c\ s\ t\ cf{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ \ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ unfold{\isacharunderscore}locales%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\ \ \isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isasymequiv}\ flow{\isacharunderscore}of{\isacharunderscore}cf\ cf{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{lemma}\isamarkupfalse%
\ f{\isacharunderscore}unique{\isacharcolon}\isanewline
\ \ \ \ \isakeyword{assumes}\ {\isachardoublequoteopen}NPreflow\ c\ s\ t\ f{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{assumes}\ A{\isacharcolon}\ {\isachardoublequoteopen}cf\ {\isacharequal}\ residualGraph\ c\ f{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{shows}\ {\isachardoublequoteopen}f{\isacharprime}\ {\isacharequal}\ f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \ \ \isacommand{interpret}\isamarkupfalse%
\ f{\isacharprime}{\isacharcolon}\ NPreflow\ c\ s\ t\ f{\isacharprime}\ \isacommand{by}\isamarkupfalse%
\ fact\isanewline
\ \ \ \ \isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ f{\isacharunderscore}def{\isacharbrackleft}abs{\isacharunderscore}def{\isacharbrackright}\ flow{\isacharunderscore}of{\isacharunderscore}cf{\isacharunderscore}def{\isacharbrackleft}abs{\isacharunderscore}def{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ A\ residualGraph{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}rule\ ext{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isacharprime}{\isachardot}capacity{\isacharunderscore}const\ \isacommand{unfolding}\isamarkupfalse%
\ E{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}auto\ split{\isacharcolon}\ prod{\isachardot}split{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ antisym{\isacharparenright}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\ \ \isacommand{lemma}\isamarkupfalse%
\ is{\isacharunderscore}NPreflow{\isacharcolon}\ {\isachardoublequoteopen}NPreflow\ c\ s\ t\ {\isacharparenleft}flow{\isacharunderscore}of{\isacharunderscore}cf\ cf{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ \ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}fold\ f{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ EX{\isacharunderscore}RPG\ f{\isacharunderscore}unique\ \isacommand{by}\isamarkupfalse%
\ metis%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \ \ \isanewline
\ \ \isacommand{sublocale}\isamarkupfalse%
\ f{\isacharcolon}\ NPreflow\ c\ s\ t\ f%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ f{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}rule\ is{\isacharunderscore}NPreflow{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\ \ \isacommand{lemma}\isamarkupfalse%
\ rg{\isacharunderscore}is{\isacharunderscore}cf{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}residualGraph\ c\ f\ {\isacharequal}\ cf{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ \ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ EX{\isacharunderscore}RPG\ f{\isacharunderscore}unique\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\ \ \isacommand{lemma}\isamarkupfalse%
\ rg{\isacharunderscore}fo{\isacharunderscore}inv{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}residualGraph\ c\ {\isacharparenleft}flow{\isacharunderscore}of{\isacharunderscore}cf\ cf{\isacharparenright}\ {\isacharequal}\ cf{\isachardoublequoteclose}\ \ \isanewline
%
\isadelimproof
\ \ \ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ rg{\isacharunderscore}is{\isacharunderscore}cf\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ f{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{{\isachardot}}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \ \ \isanewline
\isanewline
\ \ \isacommand{sublocale}\isamarkupfalse%
\ cf{\isacharcolon}\ Graph\ cf%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{{\isachardot}}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\ \ \isacommand{lemma}\isamarkupfalse%
\ resV{\isacharunderscore}netV{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}cf{\isachardot}V\ {\isacharequal}\ V{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ \ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ f{\isachardot}resV{\isacharunderscore}netV\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\ \ \isacommand{sublocale}\isamarkupfalse%
\ cf{\isacharcolon}\ Finite{\isacharunderscore}Graph\ cf\ \isanewline
%
\isadelimproof
\ \ \ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ unfold{\isacharunderscore}locales\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\ \ \isacommand{lemma}\isamarkupfalse%
\ E{\isacharunderscore}ss{\isacharunderscore}cfinvE{\isacharcolon}\ {\isachardoublequoteopen}E\ {\isasymsubseteq}\ cf{\isachardot}E\ {\isasymunion}\ cf{\isachardot}E{\isasyminverse}{\isachardoublequoteclose}\ \ \isanewline
%
\isadelimproof
\ \ \ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ f{\isachardot}E{\isacharunderscore}ss{\isacharunderscore}cfinvE\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\ \ \isacommand{lemma}\isamarkupfalse%
\ cfE{\isacharunderscore}ss{\isacharunderscore}invE{\isacharcolon}\ {\isachardoublequoteopen}cf{\isachardot}E\ {\isasymsubseteq}\ E\ {\isasymunion}\ E{\isasyminverse}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ \ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ f{\isachardot}cfE{\isacharunderscore}ss{\isacharunderscore}invE\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \ \ \isanewline
\ \ \isacommand{lemma}\isamarkupfalse%
\ resE{\isacharunderscore}nonNegative{\isacharcolon}\ {\isachardoublequoteopen}cf\ e\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}\ \ \isanewline
%
\isadelimproof
\ \ \ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ f{\isachardot}resE{\isacharunderscore}nonNegative\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \ \ \ \ \isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{context}\isamarkupfalse%
\ NPreflow\ \isakeyword{begin}\isanewline
\ \ \isacommand{lemma}\isamarkupfalse%
\ is{\isacharunderscore}RPreGraph{\isacharcolon}\ {\isachardoublequoteopen}RPreGraph\ c\ s\ t\ cf{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ \ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ unfold{\isacharunderscore}locales\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}rule\ exI{\isacharbrackleft}\isakeyword{where}\ x{\isacharequal}f{\isacharbrackright}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}safe{\isacharsemicolon}\ unfold{\isacharunderscore}locales{\isacharparenright}\isanewline
\ \ \ \ \isacommand{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\ \ \isacommand{lemma}\isamarkupfalse%
\ fo{\isacharunderscore}rg{\isacharunderscore}inv{\isacharcolon}\ {\isachardoublequoteopen}flow{\isacharunderscore}of{\isacharunderscore}cf\ cf\ {\isacharequal}\ f{\isachardoublequoteclose}\ \ \isanewline
%
\isadelimproof
\ \ \ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ flow{\isacharunderscore}of{\isacharunderscore}cf{\isacharunderscore}def{\isacharbrackleft}abs{\isacharunderscore}def{\isacharbrackright}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ residualGraph{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}rule\ ext{\isacharparenright}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ capacity{\isacharunderscore}const\ \isacommand{unfolding}\isamarkupfalse%
\ E{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}clarsimp\ split{\isacharcolon}\ prod{\isachardot}split{\isacharparenright}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ antisym{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{end}\isamarkupfalse%
\ \ \ \ \isanewline
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ NPreflow{\isacharparenright}\isanewline
\ \ {\isachardoublequoteopen}flow{\isacharunderscore}of{\isacharunderscore}cf\ {\isacharparenleft}residualGraph\ c\ f{\isacharparenright}\ {\isacharequal}\ f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}rule\ fo{\isacharunderscore}rg{\isacharunderscore}inv{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{locale}\isamarkupfalse%
\ RGraph\ %
\isamarkupcmt{Locale that characterizes a residual graph of a network%
}
\isanewline
{\isacharequal}\ Network\ {\isacharplus}\isanewline
\ \ \isakeyword{fixes}\ cf\isanewline
\ \ \isakeyword{assumes}\ EX{\isacharunderscore}RG{\isacharcolon}\ {\isachardoublequoteopen}{\isasymexists}f{\isachardot}\ NFlow\ c\ s\ t\ f\ {\isasymand}\ cf\ {\isacharequal}\ residualGraph\ c\ f{\isachardoublequoteclose}\isanewline
\isakeyword{begin}\ \ \isanewline
\ \ \isacommand{sublocale}\isamarkupfalse%
\ RPreGraph\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ \ \ \ \isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse%
\ EX{\isacharunderscore}RG\ \isacommand{obtain}\isamarkupfalse%
\ f\ \isakeyword{where}\ \isanewline
\ \ \ \ \ \ {\isachardoublequoteopen}NFlow\ c\ s\ t\ f{\isachardoublequoteclose}\ \isakeyword{and}\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}cf\ {\isacharequal}\ residualGraph\ c\ f{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{interpret}\isamarkupfalse%
\ NFlow\ c\ s\ t\ f\ \isacommand{by}\isamarkupfalse%
\ simp\ \ \ \ \isanewline
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}f{\isachardot}\ NPreflow\ c\ s\ t\ f\ {\isasymand}\ cf\ {\isacharequal}\ residualGraph\ c\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}rule\ exI{\isacharbrackleft}\isakeyword{where}\ x{\isacharequal}{\isachardoublequoteopen}f{\isachardoublequoteclose}{\isacharbrackright}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ unfold{\isacharunderscore}locales\ \ \isanewline
\ \ \isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \ \isanewline
%
\endisadelimproof
\isanewline
\ \ \isacommand{lemma}\isamarkupfalse%
\ this{\isacharunderscore}loc{\isacharcolon}\ {\isachardoublequoteopen}RGraph\ c\ s\ t\ cf{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ \ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ unfold{\isacharunderscore}locales%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \isacommand{lemma}\isamarkupfalse%
\ this{\isacharunderscore}loc{\isacharunderscore}rpg{\isacharcolon}\ {\isachardoublequoteopen}RPreGraph\ c\ s\ t\ cf{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ \ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ unfold{\isacharunderscore}locales%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \ \ \isanewline
\ \ \isacommand{lemma}\isamarkupfalse%
\ is{\isacharunderscore}NFlow{\isacharcolon}\ {\isachardoublequoteopen}NFlow\ c\ s\ t\ {\isacharparenleft}flow{\isacharunderscore}of{\isacharunderscore}cf\ cf{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ \ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ EX{\isacharunderscore}RG\ f{\isacharunderscore}unique\ is{\isacharunderscore}NPreflow\ NFlow{\isachardot}axioms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}fold\ f{\isacharunderscore}def{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ force%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \ \isanewline
%
\endisadelimproof
\ \ \ \ \isanewline
\ \ \isacommand{sublocale}\isamarkupfalse%
\ f{\isacharcolon}\ NFlow\ c\ s\ t\ f%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ f{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}rule\ is{\isacharunderscore}NFlow{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isacommand{end}\isamarkupfalse%
\ \ \ \ \ \ \ \ \isanewline
\ \ \ \ \ \ \isanewline
\isacommand{context}\isamarkupfalse%
\ NFlow\ \isakeyword{begin}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ is{\isacharunderscore}RGraph{\isacharcolon}\ {\isachardoublequoteopen}RGraph\ c\ s\ t\ cf{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ unfold{\isacharunderscore}locales\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}rule\ exI{\isacharbrackleft}\isakeyword{where}\ x{\isacharequal}f{\isacharbrackright}{\isacharparenright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}safe{\isacharsemicolon}\ unfold{\isacharunderscore}locales{\isacharparenright}\isanewline
\ \ \isacommand{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The value of the flow can be computed from the residual graph.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ val{\isacharunderscore}by{\isacharunderscore}cf{\isacharcolon}\ {\isachardoublequoteopen}val\ {\isacharequal}\ {\isacharparenleft}{\isasymSum}{\isacharparenleft}u{\isacharcomma}v{\isacharparenright}{\isasymin}outgoing\ s{\isachardot}\ cf\ {\isacharparenleft}v{\isacharcomma}u{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isacharparenleft}s{\isacharcomma}v{\isacharparenright}\ {\isacharequal}\ cf\ {\isacharparenleft}v{\isacharcomma}s{\isacharparenright}{\isachardoublequoteclose}\ \isakeyword{for}\ v\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ cf{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ val{\isacharunderscore}alt\ outgoing{\isacharunderscore}def\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ intro{\isacharbang}{\isacharcolon}\ sum{\isachardot}cong{\isacharparenright}\ \isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \ \isanewline
%
\endisadelimproof
\ \ \ \ \ \ \isanewline
\isacommand{end}\isamarkupfalse%
\ %
\isamarkupcmt{Network with Flow%
}
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ RPreGraph{\isacharparenright}\ maxflow{\isacharunderscore}imp{\isacharunderscore}rgraph{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}isMaxFlow\ {\isacharparenleft}flow{\isacharunderscore}of{\isacharunderscore}cf\ cf{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}RGraph\ c\ s\ t\ cf{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\ \ \isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ assms\ \isacommand{interpret}\isamarkupfalse%
\ Flow\ c\ s\ t\ f\ \isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ isMaxFlow{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ f{\isacharunderscore}def{\isacharparenright}\isanewline
\ \isanewline
\ \ \isacommand{interpret}\isamarkupfalse%
\ NFlow\ c\ s\ t\ f\ \isacommand{by}\isamarkupfalse%
\ unfold{\isacharunderscore}locales\ \ \ \ \ \isanewline
\ \ \isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \ \ \ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ unfold{\isacharunderscore}locales\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}rule\ exI{\isacharbrackleft}of\ {\isacharunderscore}\ f{\isacharbrackright}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ NFlow{\isacharunderscore}axioms{\isacharparenright}\ \ \isanewline
\ \ \ \ \isacommand{done}\isamarkupfalse%
\ \ \isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \ \ \ \ \ \isanewline
%
\endisadelimproof
%
\isadelimtheory
\ \ \isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
\ %
\isamarkupcmt{Theory%
}
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
%%% Local Variables:
%%% mode: latex
%%% TeX-master: "root"
%%% End:
